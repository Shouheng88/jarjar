# JarJar:

一个 Jar 瘦身工具，用来从 jar 文件中移除你调用不到的类文件。可以用来做 Android 包体积优化优化。

## 1、原理 & 效果

以项目中应用到的类为起点，从类文件的常量池中进行解析，将这个类应用到的所有的类加入到列表中进行依次遍历，直到将间接引用到的所有的类扫描出来，然后使用 jar 加入到 jar 包当中。

效果视实际的 jar 包而定，比如我的 jar 包可以从 9M 精简到 1M 左右，效果非常明显。

## 2、使用

在 Python 脚本 `run.py` 的 main 函数中依次填入，

- 你需要用到的 jar 中的类
- jar 文件的存储位置
- 精简之后的 jar 的输出的位置

```python
if __name__ == "__main__":
    config_logging()
    jarjar = JarJar()
    jarjar.compress(['com.ibm.icu.text.CharsetDetector'], 'space/icu4j-50_2.jar', 'space/out')
```

然后在根目录执行如下指令即可，

```
python run
```

## 3、你需要注意

- 使用之前请确保 `jar`、`javap` 两个命令已经被加入到你的系统的环境变量中。
- 现在的方案还不是最极致的优化：因为现在的方案只要在一个类文件中出现就会被加入到最终的 jar 包当中，而我们需要用到的方法可能并不会用到这些类。所以，如果做方法级别的扫描能够排除更多的没必要的类文件。
- 对于在 so 中引用到的方法现在还无能为力（暂时我还没调研）。

## 其他

扎扎·賓客斯（英语：Jar Jar Binks）是乔治·卢卡斯创作的星球大战的虚构人物。在《星球大战I：魅影危机》和《星球大战前传II：克隆人的进攻》中还有在《星球大战：克隆人战争》出场。他还有在《星球大战前传III：西斯的复仇》中在最后帕德梅的丧礼出现。

<img src="res/Jar_Jar_SWSB.png" style="height:200px">
